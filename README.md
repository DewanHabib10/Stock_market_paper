# Hybrid VECM-LSTM Stock Price Prediction Framework

## ðŸ“Œ Project Overview

This project implements a robust stock price prediction framework that integrates **Vector Error Correction Models (VECM)** with **Long Short-Term Memory (LSTM)** networks. By combining econometric modeling with deep learning, this hybrid approach captures both the long-run equilibrium relationships of economic variables and the intricate non-linear patterns of market behavior .

The methodology focuses on using VECM-derived residuals and error correction terms as distinct input features for the LSTM neural network, significantly improving forecasting accuracy over independent methods .

## ðŸš€ Key Features

* **Econometric Foundation:** Uses VECM to model cointegrated time series and extract long-term equilibrium deviations .
* **Deep Learning Integration:** Implements a multi-layer LSTM (128-64-32 units) to learn temporal dependencies .
* **Advanced Feature Engineering:** Merges technical indicators (RSI, MACD) with VECM residuals to create a purely information-rich input tensor .
* **Robust Preprocessing:** Includes stationarity checks (ADF) and cointegration testing (Johansen Test) .

## ðŸ› ï¸ Prerequisites

* **OS:** Fedora Linux (or compatible Linux distribution)
* **Python:** Version 3.11 (Required for TensorFlow compatibility)

### Python Dependencies

* `pandas`, `numpy` (Data manipulation)
* `statsmodels`, `scipy` (Econometric analysis)
* `tensorflow` (Deep Learning)
* `scikit-learn` (Normalization & Metrics)
* `matplotlib` (Visualization)

## ðŸ’» Installation Guide (Fedora)

Because TensorFlow requires a specific Python version, follow these steps to set up the environment on Fedora:

```bash
# 1. Install Python 3.11 and development tools
sudo dnf install python3.11 python3.11-devel gcc

# 2. Create a virtual environment using Python 3.11
python3.11 -m venv stock_env

# 3. Activate the environment
source stock_env/bin/activate

# 4. Upgrade pip
pip install --upgrade pip

# 5. Install required libraries
pip install pandas numpy statsmodels scipy scikit-learn tensorflow matplotlib joblib

```

## ðŸ“‚ Project Structure

```text
.
â”œâ”€â”€ vecm_model.py           # Step 1: VECM modeling & Residual extraction
â”œâ”€â”€ feature_engineering.py  # Step 2: Merging VECM outputs with Technical Indicators
â”œâ”€â”€ lstm_model.py           # Step 3: LSTM Training & Prediction
â”œâ”€â”€ raw_data.csv            # Generated by Step 1 (or your input data)
â”œâ”€â”€ vecm_residuals.csv      # Intermediate output from VECM
â”œâ”€â”€ final_dataset.csv       # Final processed tensor for LSTM
â”œâ”€â”€ prediction_output.png   # Final visualization graph
â””â”€â”€ README.md               # This file

```

## âš™ï¸ How to Run

Execute the scripts in the following order to replicate the pipeline described in the paper .

### Step 1: VECM Modeling

Generates synthetic data (or loads yours), performs stationarity/cointegration checks, and extracts residuals.

```bash
python3 vecm_model.py

```

*Output:* `raw_data.csv`, `vecm_residuals.csv`

### Step 2: Feature Engineering

Calculates RSI, MACD, and Moving Averages, then merges them with the VECM residuals.

```bash
python3 feature_engineering.py

```

*Output:* `final_dataset.csv`

### Step 3: LSTM Training & Prediction

Trains the 3-layer LSTM model, performs predictions, and calculates RMSE/MAE.

```bash
python3 lstm_model.py

```

*Output:* `prediction_output.png`, Console Metrics (RMSE, MAE)

## ðŸ“Š Methodology & Performance

### 1. VECM Component

The model first verifies that variables are non-stationary but cointegrated (Rank > 0) using the Johansen procedure . It fits the equation:



The residuals () are extracted to represent unexplained volatility .

### 2. LSTM Component

A sequential neural network processes the engineered features. The architecture consists of:

* **Layer 1:** 128 Units + Dropout (0.3)
* **Layer 2:** 64 Units + Dropout (0.3)
* **Layer 3:** 32 Units + Dropout (0.3)
* **Optimizer:** Adam (LR=0.001) .

### 3. Expected Performance

According to the empirical evidence in the study, this hybrid method is expected to achieve:

* **27% reduction in RMSE** compared to standard LSTM .
* **43% improvement** over standalone VECM forecasting .
* **68.7% accuracy** in directional prediction for large peak shifts .

## ðŸ“œ License

This project is based on the research "Building a Robust Stock Price Prediction Using LSTM and VECM".
